Page({
  data: {
    navItems: [{"id":8,"short_title":"安全制度","files":[],"title":"消防安全制度","optionSelect":[],"type":1,"optionList":[{"val":10,"id":28,"title":"有","questionId":8,"status":1,"orders":"","keyWord":""},{"val":6,"id":29,"title":"无","questionId":8,"status":1,"orders":"","keyWord":""}]},{"id":9,"short_title":"培训演练","files":[],"title":"员工消防安全培训与演练","optionSelect":[],"type":1,"optionList":[{"val":10,"id":30,"title":"组织开展","questionId":9,"status":1,"orders":"","keyWord":""},{"val":0,"id":31,"title":"未组织开展","questionId":9,"status":1,"orders":"","keyWord":""}]},{"id":10,"short_title":"应急预案","files":[],"title":"灭火和应急疏散预案","optionSelect":[],"type":1,"optionList":[{"val":10,"id":32,"title":"有","questionId":10,"status":1,"orders":"","keyWord":""},{"val":0,"id":33,"title":"无","questionId":10,"status":1,"orders":"","keyWord":""}]},{"id":12,"short_title":"消防车通道","files":[],"title":"消防车通道","optionSelect":[],"type":1,"optionList":[{"val":10,"id":36,"title":"畅通","questionId":12,"status":1,"orders":"","keyWord":""},{"val":6,"id":37,"title":"被堵塞、占用","questionId":12,"status":1,"orders":"","keyWord":""},{"val":0,"id":38,"title":"无","questionId":12,"status":1,"orders":"","keyWord":""}]},{"id":2,"short_title":"疏散通道","files":[],"title":"疏散通道","optionSelect":[],"type":1,"optionList":[{"val":10,"id":7,"title":"畅通","questionId":2,"status":1,"orders":"","keyWord":""},{"val":6,"id":8,"title":"堵塞","questionId":2,"status":1,"orders":"","keyWord":""},{"val":3,"id":9,"title":"锁闭","questionId":2,"status":1,"orders":"","keyWord":""}]},{"id":3,"short_title":"安全出口","files":[],"title":"安全出口","optionSelect":[],"type":1,"optionList":[{"val":10,"id":10,"title":"畅通","questionId":3,"status":1,"orders":"","keyWord":""},{"val":6,"id":11,"title":"堵塞","questionId":3,"status":1,"orders":"","keyWord":""},{"val":3,"id":12,"title":"锁闭","questionId":3,"status":1,"orders":"","keyWord":""},{"val":0,"id":13,"title":"缺少","questionId":3,"status":1,"orders":"","keyWord":""}]},{"id":13,"short_title":"防火门","files":[],"title":"防火门","optionSelect":[],"type":1,"optionList":[{"val":10,"id":39,"title":"完好有效","questionId":13,"status":1,"orders":"","keyWord":""},{"val":6,"id":40,"title":"常闭式防火门常开","questionId":13,"status":1,"orders":"","keyWord":""},{"val":3,"id":41,"title":"损坏","questionId":13,"status":1,"orders":"","keyWord":""},{"val":10,"id":42,"title":"不涉及","questionId":13,"status":1,"orders":"","keyWord":""}]},{"id":4,"short_title":"疏散指示标志","files":[],"title":"疏散指示标志","optionSelect":[],"type":1,"optionList":[{"val":10,"id":14,"title":"完好有效","questionId":4,"status":1,"orders":"","keyWord":""},{"val":6,"id":15,"title":"损坏","questionId":4,"status":1,"orders":"","keyWord":""},{"val":3,"id":16,"title":"缺少","questionId":4,"status":1,"orders":"","keyWord":""},{"val":0,"id":17,"title":"无","questionId":4,"status":1,"orders":"","keyWord":""}]},{"id":5,"short_title":"应急照明","files":[],"title":"应急照明","optionSelect":[],"type":1,"optionList":[{"val":10,"id":18,"title":"完好有效","questionId":5,"status":1,"orders":"","keyWord":""},{"val":6,"id":19,"title":"损坏","questionId":5,"status":1,"orders":"","keyWord":""},{"val":3,"id":20,"title":"缺少","questionId":5,"status":1,"orders":"","keyWord":""},{"val":0,"id":21,"title":"无","questionId":5,"status":1,"orders":"","keyWord":""}]},{"id":6,"short_title":"障碍物","files":[],"title":"人员密集场所外墙门窗上是否设置影响逃生、灭火救援的障碍物","optionSelect":[],"type":1,"optionList":[{"val":10,"id":22,"title":"否","questionId":6,"status":1,"orders":"","keyWord":""},{"val":0,"id":23,"title":"是","questionId":6,"status":1,"orders":"","keyWord":""},{"val":10,"id":24,"title":"不涉及","questionId":6,"status":1,"orders":"","keyWord":""}]},{"id":14,"short_title":"消火栓","files":[],"title":"室内消火栓","optionSelect":[],"type":1,"optionList":[{"val":0,"id":43,"title":"未设置","questionId":14,"status":1,"orders":"","keyWord":""},{"val":10,"id":44,"title":"完好有效","questionId":14,"status":1,"orders":"","keyWord":""},{"val":6,"id":45,"title":"损坏","questionId":14,"status":1,"orders":"","keyWord":""},{"val":3,"id":46,"title":"无水","questionId":14,"status":1,"orders":"","keyWord":""},{"val":0,"id":47,"title":"配件不齐","questionId":14,"status":1,"orders":"","keyWord":""},{"val":0,"id":48,"title":"被遮挡、圈占","questionId":14,"status":1,"orders":"","keyWord":""},{"val":10,"id":49,"title":"不涉及","questionId":14,"status":1,"orders":"","keyWord":""}]},{"id":1,"short_title":"灭火器","files":[],"title":"灭火器","optionSelect":[],"type":1,"optionList":[{"val":1,"id":1,"title":"未设置","questionId":1,"status":1,"orders":"","keyWord":""},{"val":10,"id":2,"title":"完好有效","questionId":1,"status":1,"orders":"","keyWord":""},{"val":3,"id":3,"title":"失效","questionId":1,"status":1,"orders":"","keyWord":""},{"val":3,"id":4,"title":"缺少","questionId":1,"status":1,"orders":"","keyWord":""},{"val":3,"id":5,"title":"配置类型错误","questionId":1,"status":1,"orders":"","keyWord":""},{"val":6,"id":6,"title":"设置位置不当","questionId":1,"status":1,"orders":"","keyWord":""}]},{"id":15,"short_title":"消防设施","files":[],"title":"建筑消防设施","optionSelect":[],"type":1,"optionList":[{"val":10,"id":50,"title":"定期维修保养并记录","questionId":15,"status":1,"orders":"","keyWord":""},{"val":6,"id":51,"title":"无记录","questionId":15,"status":1,"orders":"","keyWord":""},{"val":3,"id":52,"title":"未定期保养修养","questionId":15,"status":1,"orders":"","keyWord":""},{"val":10,"id":53,"title":"不涉及","questionId":15,"status":1,"orders":"","keyWord":""}]},{"id":11,"short_title":"消防检查结论","files":[],"title":"消防检查结论","optionSelect":[],"type":1,"optionList":[{"val":10,"id":34,"title":"合格","questionId":11,"status":1,"orders":"","keyWord":""},{"val":0,"id":35,"title":"不合格","questionId":11,"status":1,"orders":"","keyWord":""}]}]   ,
    curNav: 999999,
    toView: 999999,
	countryList: ['文城镇','锦山镇','抱罗镇','翁田镇','东阁镇','潭牛镇','东路镇'],
	countryIndex: 0,
	caijiLocation:null,
	myLocation:null
  },
  onLoad: function () {
	  this.setData({
		myLocation:getApp().globalData.location
		
	});
    // // 加载的使用进行网络访问，把需要的数据设置到data数据对象
	
	
	
     var that = this
    // wx.request({
    //   url: 'http://localhost:8080/xiaofang/small_question_list.action',
    //   method: 'GET',
    //   data: {},
    //   header: {
    //     'Accept': 'application/json'
    //   },
    //   success: function (res) {
    //     console.log(res.data)
    //     that.setData({
    //       navItems: res.data
    //     })
    //   }
    // })

  },

  //事件处理函数
  switchRightTab: function (e) {
    // 获取item项的id，和数组的下标值
    let index = e.target.dataset.index;
    this.setData({
      toView: "v" + index,
      curNav: index
    })
  },
  scrollRight: function (e) {

    // let scrollTop = e.detail.scrollTop;
    // var scrollNav = Math.round(scrollTop / this.data.viewHeight);
    //  this.setData({
    //   // curNav: scrollNav
    // })
  },
   bindCountryChange: function(e) {
        console.log('picker country 发生选择改变，携带值为', e.detail.value);

        this.setData({
            countryIndex: e.detail.value
        })
    },
  chooseMapViewTap:function(){
    var that=this;
    wx.chooseLocation({
      success:function(res){
        console.log(res);
        that.setData({
          caijiLocation:{
            latitude: res.latitude,
            longitude: res.longitude,
            name:res.name,
            address:res.address
          }
        });
      },
      fail:function(res){

      },complete:function(res){

      }
    });
  },
  optionChange: function(e){
	  let index = e.target.dataset.index;
	  let val= e.detail.value;
	  
	  var up = "navItems[" + index + "].optionSelect";
		 this.setData({
			 [up]:val
		 });
	  
	  
  },
  chooseImage: function (e) {
    var that = this;
    let index = e.target.dataset.index;
	var files = that.data.navItems[index].files;
    wx.chooseImage({
      sizeType: ['original', 'compressed'], // 可以指定是原图还是压缩图，默认二者都有
      sourceType: ['album', 'camera'], // 可以指定来源是相册还是相机，默认二者都有
      success: function (res) {
        // 返回选定照片的本地文件路径列表，tempFilePath可以作为img标签的src属性显示图片
		 console.log(files);
         files= files.concat(res.tempFilePaths);
		
		 var up = "navItems[" + index + "].files";
		 that.setData({
			 [up]:files
		 });
      }
    })
  },
  previewImage: function (e) {
	let index = e.target.dataset.index;
	var files = this.data.navItems[index].files;
    wx.previewImage({
      current: e.currentTarget.id, // 当前显示图片的http链接
      urls: files // 需要预览的图片http链接列表
    })
  },
  spliceImage: function (e) {
    var that = this;
    let index = e.target.dataset.index;
	var files = that.data.navItems[index].files;
    files.splice(e.currentTarget.dataset.image_index, 1);
    console.log(files);
    var up = "navItems[" + index + "].files";
		 that.setData({
			 [up]:files
		 });
  }


})